import{bq as n,br as t,aX as s,bs as e,bt as r,bu as i,bv as o,r as a,bw as u,aD as l,aH as c,aG as m,aE as h,aF as f,q as p}from"./vendor.d0a39f0f.js";import{t as x}from"./json.62026198.js";const g=[0,0];function y(n,t){if(!t)return null;if("x"in t){const s={x:0,y:0};return[s.x,s.y]=n(t.x,t.y,g),null!=t.z&&(s.z=t.z),null!=t.m&&(s.m=t.m),s}if("xmin"in t){const s={xmin:0,ymin:0,xmax:0,ymax:0};return[s.xmin,s.ymin]=n(t.xmin,t.ymin,g),[s.xmax,s.ymax]=n(t.xmax,t.ymax,g),t.hasZ&&(s.zmin=t.zmin,s.zmax=t.zmax,s.hasZ=!0),t.hasM&&(s.mmin=t.mmin,s.mmax=t.mmax,s.hasM=!0),s}return"rings"in t?{rings:z(t.rings,n),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:z(t.paths,n),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:b(t.points,n),hasM:t.hasM,hasZ:t.hasZ}:void 0}function z(n,t){const s=[];for(const e of n)s.push(b(e,t));return s}function b(n,t){const s=[];for(const e of n){const n=t(e[0],e[1],[0,0]);s.push(n),e.length>2&&n.push(e[2]),e.length>3&&n.push(e[3])}return s}async function _(n,t){if(!t)return;const s=Array.isArray(n)?n.map((n=>a(n.geometry)&&n.geometry.spatialReference)):[n];await u(s.map((n=>({source:n,dest:t}))))}const M=y.bind(null,n),d=y.bind(null,t);function w(n,t,a){return n?(a||(a=t,t=n.spatialReference),s(t)&&s(a)&&!e(t,a)?r(t,a)?i(a)?M(n):d(n):o(x,[n],t,a,null)[0]:n):n}const Z=new class{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(n,t,s){if(!n||!n.length||!t||!s||e(t,s))return n;const r={geometries:n,inSpatialReference:t,outSpatialReference:s,resolve:null};return this._jobs.push(r),new Promise((n=>{r.resolve=n,null===this._timer&&(this._timer=setTimeout(this._process,10))}))}_process(){this._timer=null;const n=this._jobs.shift();if(!n)return;const{geometries:t,inSpatialReference:s,outSpatialReference:e,resolve:a}=n;r(s,e)?i(e)?a(t.map(M)):a(t.map(d)):a(o(x,t,s,e,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}};function j(n,t,s){return Z.push(n,t,s)}const v=(n,t,s)=>[t,s],R=(n,t,s)=>[t,s,n[2]],P=(n,t,s)=>[t,s,n[2],n[3]];function A(n){return n?{originPosition:"upper-left"===n.originPosition?"upperLeft":"lower-left"===n.originPosition?"lowerLeft":n.originPosition,scale:n.tolerance?[n.tolerance,n.tolerance]:[1,1],translate:n.extent?[n.extent.xmin,n.extent.ymax]:[0,0]}:null}function S({scale:n,translate:t},s){return Math.round((s-t[0])/n[0])}function q({scale:n,translate:t},s){return Math.round((t[1]-s)/n[1])}function L(n,t,s){const e=[];let r,i,o,a;for(let u=0;u<s.length;u++){const l=s[u];u>0?(o=S(n,l[0]),a=q(n,l[1]),o===r&&a===i||(e.push(t(l,o-r,a-i)),r=o,i=a)):(r=S(n,l[0]),i=q(n,l[1]),e.push(t(l,r,i)))}return e.length>0?e:null}function T({scale:n,translate:t},s){return s*n[0]+t[0]}function D({scale:n,translate:t},s){return t[1]-s*n[1]}function E(n,t,s){const e=new Array(s.length);if(!s.length)return e;const[r,i]=n.scale;let o=T(n,s[0][0]),a=D(n,s[0][1]);e[0]=t(s[0],o,a);for(let u=1;u<s.length;u++){const n=s[u];o+=n[0]*r,a-=n[1]*i,e[u]=t(n,o,a)}return e}function F(n,t,s){const e=new Array(s.length);for(let r=0;r<s.length;r++)e[r]=E(n,t,s[r]);return e}function G(n,t,s,e,r){return t.points=function(n,t,s,e){return L(n,s?e?P:R:e?R:v,t)}(n,s.points,e,r),t}function H(n,t,s,e,r){return t.x=S(n,s.x),t.y=q(n,s.y),t!==s&&(e&&(t.z=s.z),r&&(t.m=s.m)),t}function X(n,t,s,e,r){const i=function(n,t,s,e){const r=[],i=s?e?P:R:e?R:v;for(let o=0;o<t.length;o++){const s=L(n,i,t[o]);s&&s.length>=3&&r.push(s)}return r.length?r:null}(n,s.rings,e,r);return i?(t.rings=i,t):null}function k(n,t,s,e,r){const i=function(n,t,s,e){const r=[],i=s?e?P:R:e?R:v;for(let o=0;o<t.length;o++){const s=L(n,i,t[o]);s&&s.length>=2&&r.push(s)}return r.length?r:null}(n,s.paths,e,r);return i?(t.paths=i,t):null}function B(n,t){return n&&t?l(t)?H(n,{},t,!1,!1):c(t)?k(n,{},t,!1,!1):m(t)?X(n,{},t,!1,!1):h(t)?G(n,{},t,!1,!1):f(t)?function(n,t,s,e,r){return t.xmin=S(n,s.xmin),t.ymin=q(n,s.ymin),t.xmax=S(n,s.xmax),t.ymax=q(n,s.ymax),t!==s&&(e&&(t.zmin=s.zmin,t.zmax=s.zmax),r&&(t.mmin=s.mmin,t.mmax=s.mmax)),t}(n,{},t,!1,!1):null:null}function C(n,t,s,e,r){return a(s)&&(t.points=function(n,t,s,e){return E(n,s?e?P:R:e?R:v,t)}(n,s.points,e,r)),t}function I(n,t,s,e,r){return p(s)||(t.x=T(n,s.x),t.y=D(n,s.y),t!==s&&(e&&(t.z=s.z),r&&(t.m=s.m))),t}function J(n,t,s,e,r){return a(s)&&(t.rings=function(n,t,s,e){return F(n,s?e?P:R:e?R:v,t)}(n,s.rings,e,r)),t}function K(n,t,s,e,r){return a(s)&&(t.paths=function(n,t,s,e){return F(n,s?e?P:R:e?R:v,t)}(n,s.paths,e,r)),t}export{J as B,K as C,j as M,H as O,B as U,_ as f,w as g,C as q,A as s,I as v};
